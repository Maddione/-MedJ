# MedJ — Персонален здравен дневник

## MedJ е Django-базиран уебсайт за централизирано съхранение, обработка и визуализация на лична медицинска информация. Чрез използване на OCR (Google Cloud Vision API) и AI проектът автоматизира извличането на данни от документи и представянето им по ясен и споделяем начин. Проектът е разработен като магистърска теза в ТУ-София.

# Технологии
Python 3.13 

Django 5.0.6 (или 5.2.3, според някои логове) 

Google Cloud Vision API (за OCR) 
OpenAI GPT-4o (за AI анализ и структуриране на данни) 
SQLite (за база данни в разработка) 
PostgreSQL (планиран за продукция) 
Tailwind CSS (за frontend стилизиране) 
HTML (Django Templates) 
JavaScript (за frontend интерактивност)
Git (за контрол на версиите) 


# Основни функционалности
Качване на PDF или изображения на медицински документи 
OCR обработка чрез Google Cloud Vision API 
Автоматично извличане на структурирани данни (лабораторни показатели като TSH, глюкоза, хемоглобин; диагнози; планове за лечение; наративни секции) 
Анонимизиране на чувствителна информация в текста след извличане на нужните данни.
Обобщения и групиране по медицински отрасъл, тип документ и дата 
Визуализация на стойности по дати (например кръвни показатели в графики) 
Потребителски профили с възможност за родител/настойник режим 
Генериране на споделяеми отчети (PDF или QR линк) (предстои) 
## Автор
## Таня Узунова, 961324004 ТУ-София

Този проект е част от магистърска теза: „Персонален здравен дневник – цялата медицинска информация на едно място“ 

## Примерен изглед на сайта
 


## Клониране на репозиторията

1.Отворете терминал и изпълнете:

Bash

git clone https://github.com/Maddione/MedJ2.0.git
cd MedJ2.0

2. Настройка на виртуална среда

Препоръчително е да използвате виртуална среда за изолиране на зависимостите.

Bash

python -m venv .venv
На Windows:
Bash

.\.venv\Scripts\activate
На macOS/Linux:
Bash

source .venv/bin/activate

3. Инсталиране на зависимости

След като виртуалната среда е активирана, инсталирайте Python и Node.js зависимостите.

Инсталиране на Python пакети:

Bash

pip install -r requirements.txt
Инсталиране на Node.js пакети (за Tailwind CSS):

Bash

npm install

4. Конфигурация на проекта

Създайте .env файл във вашата коренна директория (MedJ2.0/), за да съхранявате чувствителни променливи.

Създайте файл на име .env и добавете следното съдържание, като замените примерните стойности с вашите:

DJANGO_SECRET_KEY=your_very_secret_django_key_here
DJANGO_DEBUG=True
DJANGO_ALLOWED_HOSTS=127.0.0.1,localhost

OPENAI_API_KEY=your_openai_api_key_here
GOOGLE_CLOUD_VISION_KEY=your_google_cloud_vision_key_here

DJANGO_ENVIRONMENT=dev
Генерирайте DJANGO_SECRET_KEY: Можете да използвате онлайн генератор или Django shell.

Въведете вашите API ключове за OpenAI и Google Cloud Vision.

5. Настройка на база данни и миграции

Преди да стартирате сървъра, трябва да подготвите базата данни.

Bash

# Изтрийте стари миграции и база данни за чист старт (само ако е първоначална настройка и нямате важни данни!)
# ВНИМАНИЕ: Това ще изтрие всички данни!
# del db.sqlite3
# del MedJ\migrations\000*
# del __pycache__ - във всички директории

# Създаване на миграции за вашето приложение
python manage.py makemigrations MedJ

# Прилагане на миграциите към базата данни
python manage.py migrate
Създайте суперпотребител за достъп до административния панел:

Bash

python manage.py createsuperuser

6. Стартиране на Tailwind CSS компилатора
7. 
Tailwind CSS изисква процес на компилация. Трябва да го стартирате в отделен терминал и да го оставите да работи по време на разработка.

Отворете първи терминал в коренната директория на проекта.

Активирайте виртуалната среда: .\.venv\Scripts\activate

Стартирайте Tailwind в режим на наблюдение:

Bash

npm run watch:css
Този процес ще генерира MedJ/static/css/output.css.

7. Стартиране на Django сървъра

Отворете втори терминал в коренната директория на проекта.

Активирайте виртуалната среда: .\.venv\Scripts\activate

Стартирайте Django сървъра:

Bash

python manage.py runserver
По подразбиране приложението ще е достъпно на http://127.0.0.1:8000/.

8. Първоначално попълване на данни (административен панел)

След като сървърът работи, е важно да попълните някои начални данни, за да може приложението да функционира правилно, особено страницата за качване.

Достъпете административния панел: http://127.0.0.1:8000/admin/
Влезте с акаунта на суперпотребителя.
Критично: Попълнете данни в следните модели:
Medical Categories: Добавете вашите основни категории (напр. "Резултати от изследвания", "Обобщени документи от лекар", "Образна и функционална диагностика", "Административни документи", "Други").
Medical Specialties: Добавете вашите конкретни специалности (напр. "Кръвни изследвания", "Епикриза", "Кардиология", "ЯМР") и ги свържете с правилните категории. Уверете се, че имате поне няколко специалности, свързани с всяка категория, която планирате да използвате.
Practitioners: Добавете няколко примерни лекари/специалисти (напр. "Д-р Иван Иванов", "Д-р Мария Стефанова").
Document Tags: Можете да добавите някои начални тагове, ако искате, въпреки че системата генерира системни тагове автоматично.

9. Тестване на основните функционалности

10. След като попълните данните:

Тествайте страницата за качване (/upload/):

Отидете на http://127.0.0.1:8000/upload/
Направете Hard Reload (принудително презареждане) на страницата (Ctrl + Shift + R на Windows/Linux или Cmd + Shift + R на Mac), за да заредите най-новите промени.
Проверете визията: Уверете се, че дизайнът е според мокъпа – цветове, закръгляния, подредба на блоковете.
Проверете падащите менюта: Трябва да са попълнени с данните, които въведохте в админ панела. Менюто "Медицинска категория" трябва да се активира след избор на "Тип на събитието", а "Специалност/Изследване" - след избор на "Категория".
Тествайте бутона "Качи и анализирай документа": Той трябва да е неактивен, докато всички задължителни полета не са попълнени.
Качете примерен файл (изображение или PDF):
Попълнете всички падащи менюта.
Изберете файл.
Изберете типа на файла (изображение/PDF).
Натиснете "Качи и анализирай документа".
Наблюдавайте: Трябва да видите spinner на бутона.
Преглед на OCR текста: След OCR, страницата трябва да се обнови, показвайки OCR текста за редакция и визуализация на документа.
Финализиране на анализа:
Можете да редактирате текста.
Натиснете "Одобри и анализирай с AI".
Наблюдавайте: Трябва да видите spinner.
Преглед на резултатите: След успешно анализиране, трябва да видите секция с обобщение и (ако има) HTML таблица с резултати. Проверете дали данните (особено лабораторните резултати) са запазени правилно в административния панел за събитието.
Тествайте други страници:

http://127.0.0.1:8000/dashboard/: Проверете визията и дали показват последните събития (ако има).
http://127.0.0.1:8000/medical-events/: Проверете списъка с медицински събития.
http://127.0.0.1:8000/medical-events/<UUID>/detail/: Кликнете на събитие, за да видите детайлите. Проверете дали всички данни (лабораторни резултати, наративни секции и т.н.) се показват.
http://127.0.0.1:8000/upload-history/: Проверете списъка с качени документи.
