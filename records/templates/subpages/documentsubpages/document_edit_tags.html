{% extends 'basetemplates/base_app.html' %}
{% load i18n %}
{% block app_content %}
<main class="bg-site-background min-h-screen p-4 md:p-8">
  <div class="container mx-auto max-w-3xl">
    <div class="bg-block-background p-6 rounded-3xl shadow-lg mb-8">
      <h1 class="text-3xl font-bold text-gray-800">{% trans "Редакция на тагове за документ" %}</h1>
      <p class="mt-2 text-gray-600">{{ document.display_title }}</p>
    </div>
    <div class="bg-block-background p-6 rounded-3xl shadow-lg">
      <form method="post" class="space-y-6">
        {% csrf_token %}
        <div>
          <label class="block text-sm font-medium text-gray-700 mb-2" for="id_tags">{% trans "Етикети" %}</label>
          {% if form.tags.help_text %}
            <p class="text-sm text-gray-500 mb-3">{{ form.tags.help_text }}</p>
          {% endif %}
          <div class="bg-white rounded-2xl border border-gray-200 p-4">
            <div class="flex justify-end mb-3">
              <button type="button" id="clear-tags" class="px-3 py-1.5 text-sm rounded-lg bg-gray-100 text-gray-700 hover:bg-gray-200">{% trans "Изчисти избора" %}</button>
            </div>
            {{ form.tags }}
          </div>
          {% if form.tags.errors %}
            <div class="text-sm text-red-600 mt-1">{% for error in form.tags.errors %}{{ error }}{% if not forloop.last %}<br>{% endif %}{% endfor %}</div>
          {% endif %}
        </div>
        <div class="flex gap-3">
          <button class="px-6 py-3 bg-button-blue text-white rounded-lg">{% trans "Запази" %}</button>
          <a href="{% url 'medj:document_detail' pk=document.id %}" class="px-6 py-3 bg-gray-200 rounded-lg text-gray-800">{% trans "Отказ" %}</a>
        </div>
      </form>
    </div>
  </div>
</main>
<script>
  document.addEventListener('DOMContentLoaded', function(){
    var clearBtn=document.getElementById('clear-tags');
    if(!clearBtn){return;}
    clearBtn.addEventListener('click', function(){
      var box=document.getElementById('id_tags');
      if(!box){return;}
      box.querySelectorAll('input[type="checkbox"]').forEach(function(cb){ cb.checked=false; });
    });
  });
</script>
{% endblock %}
