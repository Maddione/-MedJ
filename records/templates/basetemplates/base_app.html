{% load static i18n tailwind_tags %}
<!DOCTYPE html>
<html lang="{% get_current_language as LANGUAGE_CODE %}{{ LANGUAGE_CODE }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{% block title %}MedJ{% endblock %}</title>
  {% tailwind_css %}
  {% block head_extra %}{% endblock %}
</head>
<body class="min-h-dvh antialiased
             bg-gradient-to-br from-cyan-50 via-white to-cyan-100
             dark:from-slate-900 dark:via-slate-900 dark:to-slate-950">

  <!-- NAVBAR (cyan, rounded lower corners) -->
  <header class="sticky top-0 z-50">
    <div class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8">
      <nav class="mt-3 rounded-b-2xl shadow-lg ring-1 ring-black/5
                  bg-cyan-600/90 supports-[backdrop-filter]:bg-cyan-600/70 backdrop-blur">
        <div class="flex items-center justify-between px-4 py-3">

          <!-- Brand -->
          <div class="flex items-center gap-3">
            {% url 'medj:landingpage' as landing_url %}
            <a href="{{ landing_url|default:'/' }}" class="flex items-center gap-2">
              <img src="{% static 'images/logo.svg' %}" alt="MedJ" class="h-8 w-auto"
                   onerror="this.style.display='none'">
              <span class="text-white font-semibold tracking-wide">MedJ</span>
            </a>
          </div>

          <!-- Right side: (child templates can inject buttons here) + Language -->
          <div class="flex items-center gap-2">
            {% block nav_actions %}{% endblock %}

            <!-- Language dropdown -->
            <form method="post" action="{% url 'set_language' %}" class="ml-1">
              {% csrf_token %}
              <input type="hidden" name="next" value="{{ request.get_full_path }}">
              {% get_current_language as LANGUAGE_CODE %}
              {% get_available_languages as languages %}
              <label for="lang" class="sr-only">{% trans "Language" %}</label>
              <select id="lang" name="language"
                      class="rounded-md bg-white/90 text-slate-800 text-sm px-2 py-1
                             outline outline-1 -outline-offset-1 outline-white/30
                             hover:bg-white focus:outline-2 focus:-outline-offset-2 focus:outline-white">
                {% for code,name in languages %}
                  <option value="{{ code }}" {% if code == LANGUAGE_CODE %}selected{% endif %}>{{ name }}</option>
                {% endfor %}
              </select>
            </form>
          </div>
        </div>
      </nav>
    </div>
  </header>

  <!-- Content wrapper -->
  <main class="mx-auto max-w-7xl px-4 sm:px-6 lg:px-8 py-8">
    {% if messages %}
      <div class="space-y-2 mb-6">
        {% for message in messages %}
          <div class="rounded-md px-4 py-3 text-sm
                      {% if message.tags == 'error' %}bg-red-50 text-red-700 ring-1 ring-red-200
                      {% elif message.tags == 'warning' %}bg-amber-50 text-amber-800 ring-1 ring-amber-200
                      {% elif message.tags == 'success' %}bg-emerald-50 text-emerald-800 ring-1 ring-emerald-200
                      {% else %}bg-slate-50 text-slate-700 ring-1 ring-slate-200{% endif %}">
            {{ message }}
          </div>
        {% endfor %}
      </div>
    {% endif %}

    {% block content %}{% endblock %}
  </main>

  <footer class="py-10 text-center text-xs text-slate-500">
    Â© <span id="y">{{ now|date:"Y" }}</span> MedJ
  </footer>

  {% block body_end %}{% endblock %}
</body>
</html>
