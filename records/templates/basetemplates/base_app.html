{% extends "basetemplates/base.html" %}
{% load static i18n %}

{% block title %}MedJ{% endblock %}

{% block nav_buttons %}
<nav class="w-full flex items-center">
  <div class="flex items-center gap-6">
    <a href="{% url 'medj:dashboard' %}"
       class="px-5 py-2 font-bold uppercase tracking-wide {% if request.resolver_match.url_name == 'dashboard' %}bg-[var(--color-blockbg)] text-[var(--color-primaryDark)] rounded-[28px] shadow-md{% else %}text-white hover:text-white/90{% endif %}">
      {% trans "Табло" %}
    </a>
    <a href="{% url 'medj:casefiles' %}"
       class="px-5 py-2 font-bold uppercase tracking-wide {% if request.resolver_match.url_name == 'casefiles' %}bg-[var(--color-blockbg)] text-[var(--color-primaryDark)] rounded-[28px] shadow-md{% else %}text-white hover:text-white/90{% endif %}">
      {% trans "Досие" %}
    </a>
    <a href="{% url 'medj:personalcard' %}"
       class="px-5 py-2 font-bold uppercase tracking-wide {% if request.resolver_match.url_name == 'personalcard' or request.resolver_match.url_name == 'personal_card' %}bg-[var(--color-blockbg)] text-[var(--color-primaryDark)] rounded-[28px] shadow-md{% else %}text-white hover:text-white/90{% endif %}">
      {% trans "Л.Картон" %}
    </a>
    <a href="{% url 'medj:documents' %}"
       class="px-5 py-2 font-bold uppercase tracking-wide {% if request.resolver_match.url_name == 'documents' %}bg-[var(--color-blockbg)] text-[var(--color-primaryDark)] rounded-[28px] shadow-md{% else %}text-white hover:text-white/90{% endif %}">
      {% trans "Документи" %}
    </a>
  </div>
</nav>
{% endblock %}

{% block nav_user %}
<div class="ml-auto flex items-center gap-3">
  <a href="{% url 'medj:upload' %}" class="px-5 py-2 rounded-2xl bg-primaryDark text-white hover:bg-primaryDark/90 transition">{% trans "Качи" %}</a>
  <a href="{% url 'medj:share' %}" class="px-5 py-2 rounded-2xl bg-success text-white hover:bg-success/90 transition">{% trans "Сподели" %}</a>
  <div class="relative" id="userMenuWrap">
    <button id="userMenuBtn" class="flex items-center gap-2 px-3 py-1 rounded-xl bg-white/10 hover:bg-white/20 text-white">
      <img src="{% static 'images/profileicon.png' %}" class="w-6 h-6 rounded-full" alt="">
      <span>{{ request.user.get_full_name|default:request.user.username }}</span>
      <i class="fa-solid fa-chevron-down ml-1"></i>
    </button>
    <div id="userMenu" class="hidden absolute right-0 mt-2 w-64 bg-white rounded-xl shadow-xl p-2 z-50">
      <div class="px-3 py-2 text-xs font-semibold text-gray-500">{% trans "Страници" %}</div>
      <a href="{% url 'medj:documents' %}" class="block px-3 py-2 rounded-lg hover:bg-black/5">{% trans "Документи" %}</a>
      <a href="{% url 'medj:event_history' %}" class="block px-3 py-2 rounded-lg hover:bg-black/5">{% trans "История на събития" %}</a>
      <a href="{% url 'medj:upload_history' %}" class="block px-3 py-2 rounded-lg hover:bg-black/5">{% trans "История на качванията" %}</a>
      <a href="{% url 'medj:doctors' %}" class="block px-3 py-2 rounded-lg hover:bg-black/5">{% trans "Лекари" %}</a>
      <a href="{% url 'medj:labtests' %}" class="block px-3 py-2 rounded-lg hover:bg-black/5">{% trans "Лабораторни изследвания" %}</a>
      <div class="my-2 border-t border-black/10"></div>
      <div class="px-3 py-2 text-xs font-semibold text-gray-500">{% trans "Профил" %}</div>
      <a href="{% url 'medj:profile' %}" class="block px-3 py-2 rounded-lg hover:bg-black/5">{% trans "Настройки" %}</a>
      <a href="{% url 'medj:password_change' %}" class="block px-3 py-2 rounded-lg hover:bg-black/5">{% trans "Смяна на парола" %}</a>
      <div class="my-2 border-t border-black/10"></div>
      <form method="post" action="{% url 'medj:logout' %}" class="px-2 pb-1">
        {% csrf_token %}
        <button class="w-full px-3 py-2 rounded-lg bg-success text-white hover:bg-success/90">{% trans "Изход" %}</button>
      </form>
    </div>
  </div>
</div>
<script>
(function(){
  var w=document.getElementById('userMenuWrap');
  var b=document.getElementById('userMenuBtn');
  var m=document.getElementById('userMenu');
  if(!b||!m) return;
  function t(e){ e.stopPropagation(); m.classList.toggle('hidden'); }
  function d(e){ if(!w.contains(e.target)) m.classList.add('hidden'); }
  b.addEventListener('click', t);
  document.addEventListener('click', d);
})();
</script>
{% endblock %}

{% block body_content %}
<div class="w-[98%] mx-auto bg-blockbg rounded-3xl shadow-md flex-1 min-h-[calc(100vh-160px)] p-4">
  {% block app_content %}{% endblock %}
</div>
{% endblock %}
