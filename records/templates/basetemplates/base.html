{% load static i18n %}
<!DOCTYPE html>
<html lang="{{ LANGUAGE_CODE|default:'en' }}">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>{% block title %}MedJ{% endblock %}</title>
  <link rel="stylesheet" href="{% static 'css/tailwind.css' %}">
  {% block extra_head %}{% endblock %}
</head>
<body class="min-h-screen bg-brand-cream">
  <header class="m-4">
    <div class="mx-auto max-w-6xl bg-nav-cyan rounded-b-3xl shadow-soft">
      <div class="px-6 py-3 flex items-center justify-between">
        <a href="{% url 'medj:landingpage' %}" class="flex items-center gap-3">
          <span class="text-white text-2xl font-semibold tracking-wide">MedJ</span>
        </a>
        <div class="flex items-center gap-4">
          <div class="relative" x-data x-cloak>
            <button id="lang-toggle" type="button" class="inline-flex items-center gap-2 px-3 py-2 rounded-lg bg-white/10 text-white hover:bg-white/20 focus:outline-none">
              {% get_current_language as LANGUAGE_CODE %}
              {% if LANGUAGE_CODE == 'bg' %}
              <svg class="w-5 h-5 rounded-full" viewBox="0 0 512 512" aria-hidden="true"><rect width="512" height="170.7" y="0" fill="#fff"/><rect width="512" height="170.7" y="170.7" fill="#00966E"/><rect width="512" height="170.7" y="341.3" fill="#D62612"/></svg>
              <span>Български</span>
              {% else %}
              <svg class="w-5 h-5 rounded-full" viewBox="0 0 3900 3900" aria-hidden="true"><path fill="#b22234" d="M0 0h7410v3900H0z"/><path d="M0 450h7410m0 600H0m0 600h7410m0 600H0m0 600h7410m0 600H0" stroke="#fff" stroke-width="300"/><path fill="#3c3b6e" d="M0 0h2964v2100H0z"/></svg>
              <span>English</span>
              {% endif %}
            </button>
            <div id="lang-menu" class="hidden absolute right-0 mt-2 w-44 rounded-lg bg-white shadow-sm ring-1 ring-black/5">
              <form method="post" action="{% url 'set_language' %}" class="py-2">
                {% csrf_token %}
                <input type="hidden" name="next" value="{{ request.path }}">
                <button name="language" value="en" class="w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2">
                  <svg class="h-3.5 w-3.5 rounded-full" viewBox="0 0 3900 3900" aria-hidden="true"><path fill="#b22234" d="M0 0h7410v3900H0z"/><path d="M0 450h7410m0 600H0m0 600h7410m0 600H0m0 600h7410m0 600H0" stroke="#fff" stroke-width="300"/><path fill="#3c3b6e" d="M0 0h2964v2100H0z"/></svg>
                  English
                </button>
                <button name="language" value="bg" class="w-full px-4 py-2 text-left text-sm hover:bg-gray-100 flex items-center gap-2">
                  <svg class="h-3.5 w-3.5 rounded-full" viewBox="0 0 512 512" aria-hidden="true"><rect width="512" height="170.7" y="0" fill="#fff"/><rect width="512" height="170.7" y="170.7" fill="#00966E"/><rect width="512" height="170.7" y="341.3" fill="#D62612"/></svg>
                  Български
                </button>
              </form>
            </div>
          </div>
          {% block nav_actions %}{% endblock %}
        </div>
      </div>
    </div>
  </header>

  <main class="mx-auto max-w-6xl px-6 py-8">
    {% block content %}{% endblock %}
  </main>

  {% block scripts %}{% endblock %}
  <script>
    const t=document.getElementById('lang-toggle');const m=document.getElementById('lang-menu');
    if(t&&m){t.addEventListener('click',()=>m.classList.toggle('hidden'));document.addEventListener('click',e=>{if(!t.contains(e.target)&&!m.contains(e.target))m.classList.add('hidden')})}
  </script>
</body>
</html>
